<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Job Finder</title>
  <style>
    table {{
      border-collapse: collapse;
      width: 90%;
    }}
    th, td {{
      border: 1px solid #000;
      padding: 8px 12px;
      text-align: left;
    }}
    th {{
      background-color: #f2f2f2;
    }}
  </style>
</head>
<body>

<div id="intro" style="display:block;">
  <p>
    First click Educational attainment. <br><br>
    Secondly, click the desired job category in the chosen educational attainment. <br><br>
    Thirdly, it will show the job names in said category, their annual wage before taxes, and affordability index (annual wage/monthly rent). <br><br>
    Fourth and finally, the google spreadsheet which the data was gathered from, with all the jobs, wages, employment availability, and affordability index will be available for download.
  </p>
  <button id="toEducation">Continue</button>
</div>

<div id="education" style="display:none;">
  <h2>Step 1: Choose Education Level</h2>
  <select id="edu" onchange="populateCategories()">
    <option value="" disabled selected>Choose an education level</option>
    {''.join([f'<option value="{edu}">{edu}</option>' for edu in formatted_jobs_data])}
  </select><br><br>
  <button id="backToIntro">Back</button>
  <button id="toCategory">Continue</button>
</div>

<div id="category" style="display:none;">
  <h2>Step 2: Choose Job Category</h2>
  <select id="cat"></select><br><br>
  <button id="backToEducation">Back</button>
  <button id="toJobs">Continue</button>
</div>

<div id="jobs" style="display:none;">
  <h2>Step 3: Job Listings</h2>
  <table id="jobTable">
    <thead>
      <tr><th>Occupation</th><th>Employment</th><th>Annual Wage</th><th>Affordability Index</th></tr>
    </thead>
    <tbody></tbody>
  </table><br>
  <button id="backToCategory">Back</button>
  <button id="toConclusion">Continue</button>
</div>

<div id="conclusion" style="display:none;">
  <h2>Step 4: Download Data</h2>
  <p>
    Download the full spreadsheet containing all job listings, wages, employment data, and affordability index:
  </p>
  <a href="https://docs.google.com/spreadsheets/d/19ziRp1iNENdopAgHci7nJTNzTbgiFV1xRYE2QhjCgq0/edit?usp=sharing" target="_blank">ðŸ“„ Google Sheet</a>
  <br><br>
  <button id="backToJobs">Back</button>
  <button onclick="window.close()">Exit</button>
</div>

<script>
let jobData = {formatted_json_clean};

function showPage(id) {{
  ['intro','education','category','jobs','conclusion'].forEach(p => {{
    document.getElementById(p).style.display = 'none';
  }});
  document.getElementById(id).style.display = 'block';
}}

document.getElementById("toEducation").addEventListener("click", () => showPage("education"));
document.getElementById("backToIntro").addEventListener("click", () => showPage("intro"));
document.getElementById("toCategory").addEventListener("click", () => showPage("category"));
document.getElementById("backToEducation").addEventListener("click", () => showPage("education"));
document.getElementById("toJobs").addEventListener("click", showJobs);
document.getElementById("backToCategory").addEventListener("click", () => showPage("category"));
document.getElementById("toConclusion").addEventListener("click", () => showPage("conclusion"));
document.getElementById("backToJobs").addEventListener("click", () => showPage("jobs"));

function populateCategories() {{
  let edu = document.getElementById("edu").value;
  let cat = document.getElementById("cat");
  cat.innerHTML = '';
  if (edu in jobData) {{
    for (let key in jobData[edu]) {{
      let option = document.createElement("option");
      option.value = key;
      option.innerText = key;
      cat.appendChild(option);
    }}
  }}
}}

function showJobs() {{
  let edu = document.getElementById("edu").value;
  let cat = document.getElementById("cat").value;
  let tbody = document.getElementById("jobTable").querySelector("tbody");
  tbody.innerHTML = '';
  if (edu in jobData && cat in jobData[edu]) {{
    jobData[edu][cat].forEach(job => {{
      let row = document.createElement("tr");
      row.innerHTML = `<td>${{job['Occupation']}}</td><td>${{job['Employment']}}</td><td>${{job['Annual Wage']}}</td><td>${{job['Affordability Index']}}</td>`;
      tbody.appendChild(row);
    }});
  }}
  showPage('jobs');
}}
</script>

</body>
</html>
